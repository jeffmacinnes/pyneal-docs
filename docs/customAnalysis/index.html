



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.0">
    
    
      
        <title>Customized Analyses - Pyneal Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.aa3de92b.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#customized-analyses" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Pyneal Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">home</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Pyneal Docs
              </span>
              <span class="md-header-nav__topic">
                Customized Analyses
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">home</i>
      
    </span>
    Pyneal Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Overview
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dataflow/" title="Data Flow" class="md-nav__link">
      Data Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pynealScanner/" title="Pyneal Scanner" class="md-nav__link">
      Pyneal Scanner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pyneal/" title="Pyneal" class="md-nav__link">
      Pyneal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../endUser/" title="End User" class="md-nav__link">
      End User
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../simulations/" title="Simulations" class="md-nav__link">
      Simulations
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Additional Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Additional Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../createMask/" title="Creating Masks" class="md-nav__link">
      Creating Masks
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Customized Analyses
      </label>
    
    <a href="./" title="Customized Analyses" class="md-nav__link md-nav__link--active">
      Customized Analyses
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-analysis-script" title="Custom Analysis Script" class="md-nav__link">
    Custom Analysis Script
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__-initialize" title="__init__ (initialize)" class="md-nav__link">
    __init__ (initialize)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preset-variables-and-creating-new-ones" title="Preset variables, and creating new ones" class="md-nav__link">
    Preset variables, and creating new ones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-log-messages" title="Adding log messages" class="md-nav__link">
    Adding log messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-specified-__init__-code" title="User-specified __init__ code" class="md-nav__link">
    User-specified __init__ code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute" title="compute" class="md-nav__link">
    compute
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-specified-compute-code" title="User-specified compute code" class="md-nav__link">
    User-specified compute code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storing-results" title="Storing results" class="md-nav__link">
    Storing results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imageOrientation/" title="Image Orientation" class="md-nav__link">
      Image Orientation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#custom-analysis-script" title="Custom Analysis Script" class="md-nav__link">
    Custom Analysis Script
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#__init__-initialize" title="__init__ (initialize)" class="md-nav__link">
    __init__ (initialize)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preset-variables-and-creating-new-ones" title="Preset variables, and creating new ones" class="md-nav__link">
    Preset variables, and creating new ones
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-log-messages" title="Adding log messages" class="md-nav__link">
    Adding log messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-specified-__init__-code" title="User-specified __init__ code" class="md-nav__link">
    User-specified __init__ code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute" title="compute" class="md-nav__link">
    compute
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-specified-compute-code" title="User-specified compute code" class="md-nav__link">
    User-specified compute code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storing-results" title="Storing results" class="md-nav__link">
    Storing results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="customized-analyses">Customized Analyses<a class="headerlink" href="#customized-analyses" title="Permanent link">&para;</a></h1>
<p>One of <strong>Pyneal's</strong> most powerful features is its ability to run customized analyses during a real-time scan. This means you can design your own analyses to fit your unique experimental needs, and <strong>Pyneal</strong> will execute those analyses on every new timepoint and store the results. </p>
<p>To take advantage of this feature, you write a custom analysis script (in <code>python</code>), and select the <code>Custom</code> button in the Analysis pane of the GUI:</p>
<p><img alt="" src="../images/customAnalysis/customAnalysis_GUI.png" /></p>
<h2 id="custom-analysis-script">Custom Analysis Script<a class="headerlink" href="#custom-analysis-script" title="Permanent link">&para;</a></h2>
<p>While custom analyses offer a lot of flexibility, there are a couple of important constraints that need to be included in the script to ensure it can be integrated into the typical <strong>Pyneal</strong> data flow. </p>
<p>The best way to ensure these constraints are met is to base your script off of the template file included with <strong>Pyneal</strong>. You can find this template in </p>
<p><code>pyneal/utils/customAnalyses/customAnalysisTemplate.py</code></p>
<p>Or, you can simply copy the text here:</p>
<pre><code class="python">import sys
import os
from os.path import join
import logging

import numpy as np
import nibabel as nib


class CustomAnalysis:
    &quot;&quot;&quot; Custom Analysis Module

    This class contains all of the methods needed for setting up and executing
    customized analyses in Pyneal during a real-time scan

    &quot;&quot;&quot;
    def __init__(self, maskFile, weightMask, numTimepts):
        &quot;&quot;&quot; Initialize the class

        Everything in the `__init__` method will be executed BEFORE the scan
        begins. This is a place to run any necessary setup code.

        The `__init__` method provides a number of inputs from the setup GUI
        that can be used to help set up a customized analyses. You are free to
        use or ignore these inputs as needed.

        Parameters
        ----------
        maskFile : string
            full path to the mask file specified in the Pyneal setup GUI
        weightMask : boolean
            flag indicating whether the &quot;weight mask?&quot; option in setup GUI was
            checked.
        numTimepts : int
            number of timepts in the run, as specified in the setup GUI

        &quot;&quot;&quot;
        # Load masks and weights, and create an within-class reference to
        # each for use in later methods.
        mask_img = nib.load(maskFile)
        if weightMask is True:
            self.weights = mask_img.get_data().copy()
        self.mask = mask_img.get_data() &gt; 0  # 3D boolean array of mask voxels

        # within-class reference to numTimepts for use in later methods
        self.numTimepts = numTimepts

        # Add the directory that this script lives in to the path. This way it
        # is easy to load any additional files you want to put in the same
        # directory as your custom analysis script
        self.customAnalysisDir = os.path.abspath(os.path.dirname(__file__))
        sys.path.append(self.customAnalysisDir)

        # Import the logger. If desired, you can write log messages to the
        # Pyneal log file using:
        # self.logger.info('my log message') - log file and stdOut
        # self.logger.debug('my log message') - log file only
        self.logger = logging.getLogger('PynealLog')

        ########################################################################
        ############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
        self.myResult = 1


        ############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
        ########################################################################

    def compute(self, vol, volIdx):
        &quot;&quot;&quot; Compute method

        This method will be executed on EACH new 3D volume that arrives
        DURING the real-time scan. Results must be returned in a dictionary. No
        restrictions on dict key names or values, but note that the volume
        index will get added automatically by Pyneal before the result gets
        placed on the results server, so no need to specify that here

        Parameters
        ----------
        vol : numpy-array
            3D array of voxel data for the current volume
        volIdx : int
            0-based index indicating where, in time (4th dimension), the volume
            belongs

        Returns
        -------
        dict
            dictionary containing key:value pair(s) for the results for the
            current volume

        &quot;&quot;&quot;
        ########################################################################
        ############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
        self.myResult += 1


        ############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
        ########################################################################

        return {'result': self.myResult}
</code></pre>

<p>The script class consists of a single class (<code>CustomAnalysis</code>) with two methods: <code>__init__</code> and <code>compute</code>. You are welcome to include any additional methods that are useful, just make sure these two methods exist. See below for details on what each method does and how to customize them. </p>
<h3 id="__init__-initialize"><code>__init__</code> (initialize)<a class="headerlink" href="#__init__-initialize" title="Permanent link">&para;</a></h3>
<p>The <code>__init__</code> method is called as soon as you hit <code>submit</code> on the setup GUI. In other words, the code in this method runs <em>before</em> the scan begins. Thus, the <code>__init__</code> method is where you will specify any set up code that needs to be initialized before the scan begins (e.g. loading multiple mask files).</p>
<p>Let's take a look at the code in more detail:</p>
<pre><code class="python">def __init__(self, maskFile, weightMask, numTimepts):
    &quot;&quot;&quot; Initialize the class

    Everything in the `__init__` method will be executed BEFORE the scan
    begins. This is a place to run any necessary setup code.

    The `__init__` method provides a number of inputs from the setup GUI
    that can be used to help set up a customized analyses. You are free to
    use or ignore these inputs as needed.

    Parameters
    ----------
    maskFile : string
        full path to the mask file specified in the Pyneal setup GUI
    weightMask : boolean
        flag indicating whether the &quot;weight mask?&quot; option in setup GUI was
        checked.
    numTimepts : int
        number of timepts in the run, as specified in the setup GUI

    &quot;&quot;&quot;
    # Load masks and weights, and create an within-class reference to
    # each for use in later methods.
    mask_img = nib.load(maskFile)
    if weightMask is True:
        self.weights = mask_img.get_data().copy()
    self.mask = mask_img.get_data() &gt; 0  # 3D boolean array of mask voxels

    # within-class reference to numTimepts for use in later methods
    self.numTimepts = numTimepts

    # Add the directory that this script lives in to the path. This way it
    # is easy to load any additional files you want to put in the same
    # directory as your custom analysis script
    self.customAnalysisDir = os.path.abspath(os.path.dirname(__file__))
    sys.path.append(self.customAnalysisDir)

    # Import the logger. If desired, you can write log messages to the
    # Pyneal log file using:
    # self.logger.info('my log message') - log file and stdOut
    # self.logger.debug('my log message') - log file only
    self.logger = logging.getLogger('PynealLog')

    ########################################################################
    ############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
    self.myResult = 1


    ############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
    ########################################################################
</code></pre>

<h4 id="preset-variables-and-creating-new-ones">Preset variables, and creating new ones<a class="headerlink" href="#preset-variables-and-creating-new-ones" title="Permanent link">&para;</a></h4>
<p>First, note that certain settings from the setup GUI are passed into the custom analysis script. Namely:</p>
<ul>
<li><code>maskFile</code>: the path to the mask specified in the GUI</li>
<li><code>weightMask</code>: a True/False boolean flag indicating whether the <code>weight mask?</code> option was checked or not.</li>
<li><code>numTimepts</code>: the number of timepts in the run, as specified in the GUI. </li>
</ul>
<p>At the top of the <code>__init__</code> method, you'll see some code that reads in each of those settings, and creates local variables for each:</p>
<pre><code class="python"># Load masks and weights, and create an within-class reference to
# each for use in later methods.
mask_img = nib.load(maskFile)
if weightMask == True:
    self.weights = mask_img.get_data().copy()
self.mask = mask_img.get_data() &gt; 0  # 3D boolean array of mask voxels

# within-class reference to numTimepts for use in later methods
self.numTimepts = numTimepts
</code></pre>

<p>This enables you to reference these variables in any other method by referring to <code>self.mask</code>, <code>self.weights</code>, and <code>self.numTimepts</code>. In fact, the same thing is true for any variable you create in the <code>__init__</code> method; in order to access the variable in other methods, you must prepend the variable name with <code>self.</code></p>
<p>The <code>__init__</code> method also contains a couple of other useful tidbits near the top. First, we add the directory that contains your custom analysis script to the path. This way, you can easily load any additional files that are exist in that same directory. </p>
<pre><code class="python"># Add the directory that this script lives in to the path. This way it
# is easy to load any additional files you want to put in the same
# directory as your custom analysis script
self.customAnalysisDir = os.path.abspath(os.path.dirname(__file__))
sys.path.append(self.customAnalysisDir)
</code></pre>

<h4 id="adding-log-messages">Adding log messages<a class="headerlink" href="#adding-log-messages" title="Permanent link">&para;</a></h4>
<p>It also creates a reference to the logger, which is the tool that adds new messages to the <code>pynealLog.log</code> output file. You can use this reference anywhere in your script to add new log messages, which will be automatically timestamped and included in the output file. You can even control the type of log message</p>
<ul>
<li><strong>info</strong> messages will get written to the output file <strong><em>AND</em></strong> appear in the stdOut of the terminal</li>
<li><strong>debug</strong> messages will only get written to the output file</li>
</ul>
<pre><code class="python"># Import the logger. If desired, you can write log messages to the
# Pyneal log file using:
# self.logger.info('my log message') - log file and stdOut
# self.logger.debug('my log message') - log file only
self.logger = logging.getLogger('PynealLog')
</code></pre>

<h4 id="user-specified-__init__-code">User-specified <code>__init__</code> code<a class="headerlink" href="#user-specified-__init__-code" title="Permanent link">&para;</a></h4>
<p>Finally, at the bottom of the <code>__init__</code> method is space for you to include any additional code that is needed. </p>
<pre><code class="python">########################################################################
############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
self.myResult = 1



############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
########################################################################
</code></pre>

<p>In order to illustrate, in the example above we're simply creating a new variable (<code>self.myResult</code>) and assigning it a value of <code>1</code>.</p>
<h3 id="compute"><code>compute</code><a class="headerlink" href="#compute" title="Permanent link">&para;</a></h3>
<p>The <code>compute</code> method is what actually gets called during a scan. In fact, it gets called each time a new 3D volume appears from the scanner. Here's the code in more detail:</p>
<pre><code class="python">def compute(self, vol, volIdx):
    &quot;&quot;&quot; Compute method

    This method will be executed on EACH new 3D volume that arrives
    DURING the real-time scan. Results must be returned in a dictionary. No
    restrictions on dict key names or values, but note that the volume
    index will get added automatically by Pyneal before the result gets
    placed on the results server, so no need to specify that here

    Parameters
    ----------
    vol : numpy-array
        3D array of voxel data for the current volume
    volIdx : int
        0-based index indicating where, in time (4th dimension), the volume
        belongs

    Returns
    -------
    dict
        dictionary containing key:value pair(s) for the results for the
        current volume

    &quot;&quot;&quot;
    ########################################################################
    ############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
    self.myResult += 1


    ############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
    ########################################################################

    return {'result': self.myResult}
</code></pre>

<p>Note that the <code>compute</code> method passes in references to the current <code>volume</code> (3D numpy array, [x,y,z]), as well as the <code>volIdx</code>, an integer representing the current volume index (in 4th dimension; 0-based index). </p>
<h4 id="user-specified-compute-code">User-specified <code>compute</code> code<a class="headerlink" href="#user-specified-compute-code" title="Permanent link">&para;</a></h4>
<p>The <code>compute</code> method includes space for you to insert your own analysis code:</p>
<pre><code class="python">########################################################################
############# vvv INSERT USER-SPECIFIED CODE BELOW vvv #################
self.myResult += 1




############# ^^^ END USER-SPECIFIED CODE ^^^ ##########################
########################################################################

</code></pre>

<p>You can use this area to write customized analysis code that will be executed on each volume. In the simple example above, each time a new volume arrives, the <code>compute</code> method will increment the <code>self.myResult</code> variable (created in the <code>__init__</code> method) by 1.</p>
<h4 id="storing-results">Storing results<a class="headerlink" href="#storing-results" title="Permanent link">&para;</a></h4>
<p>The <code>compute</code> method must return a python dictionary containing the analysis result (or results) for the current volume. </p>
<pre><code class="python">return {'result': self.myResult}
</code></pre>

<p>That said, you are free to customize the contents of this dictionary as needed to fit your experimental needs. For instance, if you are calculating the mean signal in multiple ROIs (and storing those value in variables named <code>roi1_meanSignal</code>, <code>roi2_meanSignal</code>, and <code>roi3_meanSignal</code>) your dictionary could look something like this:</p>
<pre><code class="python">{'roi1_mean': roi1_meanSignal,
'roi2_mean`: roi2_meanSignal,
'roi3_mean`: roi3_meanSignal}
</code></pre>

<p><strong>Pyneal</strong> automatically tacks on the current <code>volIdx</code> as an entry to the dictionary later on, so no need to include that information here. </p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../createMask/" title="Creating Masks" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Creating Masks
              </span>
            </div>
          </a>
        
        
          <a href="../troubleshooting/" title="Troubleshooting" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Troubleshooting
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/jeffmacinnes/pyneal" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.9fb73e57.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>