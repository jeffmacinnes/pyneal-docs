
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.3">
    
    
      
        <title>Pyneal Scanner - Pyneal Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyneal-scanner" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Pyneal Docs" class="md-header-nav__button md-logo" aria-label="Pyneal Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Pyneal Docs
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Pyneal Scanner
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Pyneal Docs" class="md-nav__button md-logo" aria-label="Pyneal Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Pyneal Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../installation/" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Overview" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../dataflow/" class="md-nav__link">
      Data Flow
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Pyneal Scanner
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Pyneal Scanner
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    Basic Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it works
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-structures-and-data-formats-by-scanner-make" class="md-nav__link">
    Directory structures and data formats by scanner make
  </a>
  
    <nav class="md-nav" aria-label="Directory structures and data formats by scanner make">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ge" class="md-nav__link">
    GE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philips" class="md-nav__link">
    Philips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#siemens" class="md-nav__link">
    Siemens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-data-to-pyneal" class="md-nav__link">
    Sending data to Pyneal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-commands" class="md-nav__link">
    Additional commands
  </a>
  
    <nav class="md-nav" aria-label="Additional commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listseries" class="md-nav__link">
    listSeries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getseries" class="md-nav__link">
    getSeries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../pyneal/" class="md-nav__link">
      Pyneal
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../endUser/" class="md-nav__link">
      End User
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../simulations/" class="md-nav__link">
      Simulations
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    
    <label class="md-nav__link" for="nav-5">
      Additional Tools
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Additional Tools" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Additional Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../createMask/" class="md-nav__link">
      Creating Masks
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../customAnalysis/" class="md-nav__link">
      Customized Analyses
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../troubleshooting/" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    
    <label class="md-nav__link" for="nav-7">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../glossary/" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../imageOrientation/" class="md-nav__link">
      Image Orientation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-usage" class="md-nav__link">
    Basic Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it works
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-structures-and-data-formats-by-scanner-make" class="md-nav__link">
    Directory structures and data formats by scanner make
  </a>
  
    <nav class="md-nav" aria-label="Directory structures and data formats by scanner make">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ge" class="md-nav__link">
    GE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#philips" class="md-nav__link">
    Philips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#siemens" class="md-nav__link">
    Siemens
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-data-to-pyneal" class="md-nav__link">
    Sending data to Pyneal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-commands" class="md-nav__link">
    Additional commands
  </a>
  
    <nav class="md-nav" aria-label="Additional commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listseries" class="md-nav__link">
    listSeries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getseries" class="md-nav__link">
    getSeries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="pyneal-scanner">Pyneal Scanner<a class="headerlink" href="#pyneal-scanner" title="Permanent link">&para;</a></h1>
<p><img alt="" src="../images/pynealScanner/pynealScanner.png" /></p>
<p>First step, make sure you've followed the instructions at <a href="../setup/#pyneal-scanner"><strong>setup: Pyneal Scanner</strong></a> to configure <strong>Pyneal Scanner</strong> to your environment.</p>
<h2 id="directory-structure">Directory Structure<a class="headerlink" href="#directory-structure" title="Permanent link">&para;</a></h2>
<p>The <strong>Pyneal Scanner</strong> directory has the following structure:</p>
<pre><code>├── pyneal_scanner
│   ├── README.md
│   ├── data
│   ├── getSeries.py
│   ├── listSeries.py
│   ├── pynealScanner.log
│   ├── pynealScanner.py
│   ├── requirements.txt
│   ├── scannerConfig.yaml
│   ├── simulation
│   └── utils 
</code></pre>
<p>The root level of the directory contains basic commands for launching <strong>Pyneal Scanner</strong> (<code>pynealScanner.py</code>), and accessing information about the current scanning session (<code>getSeries.py</code>, <code>listSeries.py</code>). </p>
<p><strong>Subdirectories</strong>:</p>
<ul>
<li>
<p><strong><code>data/</code></strong>: Any data that <strong>Pyneal Scanner</strong> saves to disk during a scanning session. For instance, using <code>getSeries.py</code> to build a nifti-formatted image from the current session will result in that file being written to this directory. </p>
</li>
<li>
<p><strong><code>simulation/</code></strong>: Tools for simulating inputs and outputs of <strong>Pyneal Scanner</strong>. See <a href="simulations/#pyneal-scanner-simulation-tools"><strong>simulations: Pyneal Scanner Simulation Tools</strong></a></p>
</li>
<li>
<p><strong><code>utils/</code></strong>: General and MRI manufacturer specific tools for settings up a scanning session, monitoring for incoming data during a scan, and processing/sending data to <strong>Pyneal</strong> throughout a scan. </p>
</li>
</ul>
<h2 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h2>
<p>To launch <strong>Pyneal Scanner</strong> from the <strong>scanner computer</strong>, open a terminal and navigate to the <code>pyneal_scanner</code> directory. From the <code>pyneal_scanner</code> directory, type:</p>
<blockquote>
<p>python pynealScanner.py</p>
</blockquote>
<p>If you have set up <strong>Pyneal Scanner</strong> correctly, you will see a print out of your settings, info about any existing series directories in the <code>scannerBaseDir</code> path, and a message that <strong>Pyneal Scanner</strong> is attempting to connect to <strong>Pyneal</strong> over the specified <code>pynealSocket</code>:</p>
<blockquote>
<p>===============<br />
SCANNER SETTINGS:<br />
pynealSocketHost: 127.0.0.1<br />
pynealSocketPort: 5555<br />
scannerBaseDir: /path/to/scanner/baseDir<br />
scannerMake: GE  <br />
============   <br />
Session Dir:<br />
/path/to/scanner/baseDir/p1/e666<br />
Series Dirs:<br />
      s1923    23.6 MB    5 min, 13 s ago<br />
      s1925    26.2 MB    1 min, 10 s ago  <br />
MainThread -  Connecting to pynealSocket...  </p>
</blockquote>
<p>Once you launch <strong>Pyneal</strong> on the <strong>analysis computer</strong>, you will see a confirmation that <strong>Pyneal Scanner</strong> has connected to <strong>Pyneal</strong>, and is now waiting for new data to arrive from the scanner:</p>
<blockquote>
<p>MainThread -  pynealSocket connected<br />
MainThread -  Waiting for new seriesDir...</p>
</blockquote>
<h2 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h2>
<p>Behind the scenes, <strong>Pyneal Scanner</strong> is running two separate threads. One thread is dedicated to monitoring the specifed directory for new data to appear. Whenever new data arrives, it places it in a queue. The 2nd thread is responsible for pulling data off of that queue, preprocessing it to convert to a standardized format, and then sending the reformatted data to <strong>Pyneal</strong> over a socket connection (defined by <code>pynealSocketHost</code> and <code>pynealSocketPort</code> in the configuration file). </p>
<p>Depending on which type of scanner you are using, the directory structure for where new data will appear, and the format that it will appear in, can differ drastically. <strong>Pyneal Scanner</strong> comes with utilities designed to handle the directory structures and formats of 3 different scanner manufacturers: <strong>GE</strong>, <strong>Philips</strong>, and <strong>Siemens</strong>. </p>
<h2 id="directory-structures-and-data-formats-by-scanner-make">Directory structures and data formats by scanner make<a class="headerlink" href="#directory-structures-and-data-formats-by-scanner-make" title="Permanent link">&para;</a></h2>
<p><strong>Pyneal Scanner</strong> is designed to handle the standard data formats used across the 3 dominant scanner manufacturers, <strong>GE</strong>, <strong>Philips</strong>, and <strong>Siemens</strong>. This section will provide details on the directory structures and data formats across each in order to help make sure you configure <strong>Pyneal Scanner</strong> correctly. </p>
<h3 id="ge">GE<a class="headerlink" href="#ge" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><em>expected data format</em>: dicom files, one file per slice. Each dicom file must contain the following tags:</p>
<ul>
<li><code>Columns</code></li>
<li><code>ImagesInAcquisition</code></li>
<li><code>ImageOrientationPatient</code></li>
<li><code>ImagePositionPatient</code> </li>
<li><code>InStackPositionNumber</code></li>
<li><code>InstanceNumber</code></li>
<li><code>MRAcquisitionType</code></li>
<li><code>NumberOfTemporalPositions</code></li>
<li><code>PixelSpacing</code></li>
<li><code>Rows</code></li>
<li><code>SliceThickness</code></li>
</ul>
</li>
<li>
<p><em>expected directory structure</em>: new dicom files are written to a directory on the scanner console. The path to that directory can be broken apart as:</p>
<ul>
<li>
<p><code>[scannerBaseDir]/[sessionDir]/[seriesDir]</code>, where</p>
<ul>
<li><code>[scannerBaseDir]</code>: path that remains constant across all scans</li>
<li><code>[sessionDir]</code>: directories that can change from session to session, named like <code>p###/e###</code> where the specific <code>#</code> values are unknown in advance.</li>
<li><code>[seriesDir]</code>: series specific directory named like <code>s###</code> where the specific <code>#</code> values are unknown in advance. Each new scan during a given exam session will be assigned a unique <code>s###</code> dir.</li>
</ul>
<p>To figure out the <code>sessionDir</code> and <code>seriesDir</code> for the current scan session, see the <a href="./#listseries"><strong>listSeries</strong></a> command below.</p>
</li>
</ul>
</li>
</ul>
<h3 id="philips">Philips<a class="headerlink" href="#philips" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><em>expected data format</em>: new PAR/REC file pairs, where each file pair represents a 3D volume. </p>
</li>
<li>
<p><em>expected directory structure</em>: Philips scanners have the option to export reconstructed PAR/REC files to a remote directory. The path to that directory can be broken apart as</p>
<ul>
<li>
<p><code>[scannerBaseDir]/[seriesDir]</code>, where  </p>
<ul>
<li>
<p><code>[scannerBaseDir]</code>: path to remote directory that remains constant across all scans</p>
</li>
<li>
<p><code>[seriesDir]</code>: series specific directory named like <code>0###</code>, where the directory name is a 4-character number (zero padded as necessary) that increases sequentially with each new series. There is a unique series directory for each scan. </p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="siemens">Siemens<a class="headerlink" href="#siemens" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><em>expected data format</em>: dicom mosaic files, where each file represents all slices from a 3D volume, arranged in mosaic format. File names are expected to follow a pattern like <code>###_######_######.dcm</code>, where the 2nd field represents the series number, and the 3rd field represents the volume number. </p>
</li>
<li>
<p><em>expected directory structure</em>:  Siemens scanners have the option to export reconstructed dicom mosaic files to a remote directory. The path to that directory can be refered to as</p>
<ul>
<li><code>[scannerBaseDir]</code></li>
</ul>
<p>The <code>[scannerBaseDir]</code> will contain all of the volume files for  <em>all series</em> in a given scan session. </p>
</li>
</ul>
<h2 id="sending-data-to-pyneal">Sending data to Pyneal<a class="headerlink" href="#sending-data-to-pyneal" title="Permanent link">&para;</a></h2>
<p>During a scan, <strong>Pyneal Scanner</strong> will automatically send data to <strong>Pyneal</strong> over a socket connection (defined by <code>pynealSocketHost</code> and <code>pynealSocketPort</code> in the configuration file). </p>
<p>Regardless of how the data is formatted coming off of the scanner (see <a href="./#directory-structures-and-data-formats-by-scanner-make"><strong>Directory structures and data formats by scanner make</strong></a> above), <strong>Pyneal Scanner</strong> will convert everything to a standardized format before sending to <strong>Pyneal</strong>. </p>
<p>Specifically, <strong>Pyneal Scanner</strong> will send data as 3D volumes. Each transmission actually takes place in 2 waves:  </p>
<ul>
<li>
<p>First, a JSON header that contains metadata about the current volume, including fields for:</p>
<ul>
<li><code>volIdx</code> - volume index (0-based) of the current volume</li>
<li><code>dtype</code> - datatype of the volume array</li>
<li><code>shape</code> - dimensions of the volume array</li>
<li><code>affine</code> - affine transformation that will convert the volume array to RAS+ orientation (see <a href="../imageOrientation/"><strong>Image Orientation</strong></a> for more info)</li>
</ul>
</li>
<li>
<p>Second, the data array for the current volume. </p>
</li>
</ul>
<p><strong>Pyneal</strong> will use information in the header message to rebuild the volume array, and carry out all subsequent preprocessing and analysis steps. </p>
<h2 id="additional-commands">Additional commands<a class="headerlink" href="#additional-commands" title="Permanent link">&para;</a></h2>
<p>The <code>pyneal_scanner</code> directory also contains a couple of other commands that may be useful during a real-time session</p>
<h3 id="listseries">listSeries<a class="headerlink" href="#listseries" title="Permanent link">&para;</a></h3>
<ul>
<li>location: <code>pyneal_scanner/listSeries.py</code></li>
<li>usage: <code>python listSeries.py</code></li>
</ul>
<p><code>listSeries.py</code> will print to the screen a list of all of the series for the current session. Each series will include information like the relevant paths, directory/file sizes, and creation dates. In the case of GE scanners, this will also report the <code>p###/e###</code> parent directories (i.e. the <code>sessionDir</code>) of new series directories. </p>
<h3 id="getseries">getSeries<a class="headerlink" href="#getseries" title="Permanent link">&para;</a></h3>
<ul>
<li>location: <code>pyneal_scanner/getSeries.py</code></li>
<li>usage: <code>python getSeries.py</code></li>
</ul>
<p><code>getSeries.py</code> will build a nifti file from a selected series from the current session. When called, it will print a list of all series for the current session, and prompt you to select one. You will also be prompted to specify an 'output prefix' that will be used to name the output file.  </p>
<p>You can select series that correspond to either 3D structural series or 4D functional series. The selected series will be converted to a single nifti file, and saved as:</p>
<p><code>pyneal_scanner/data/&lt;output prefix&gt;_&lt;seriesName&gt;.nii.gz</code></p>
<p>This tool is useful if you need to retrieve data during a session (for example, a localizer run that will be analyzed to create ROIs for the real-time runs).</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../dataflow/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Data Flow
              </div>
            </div>
          </a>
        
        
          <a href="../pyneal/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Pyneal
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/jeffmacinnes/pyneal" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>